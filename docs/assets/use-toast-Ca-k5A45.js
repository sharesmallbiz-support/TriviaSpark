var x=e=>{throw TypeError(e)};var M=(e,t,s)=>t.has(e)||x("Cannot "+s);var r=(e,t,s)=>(M(e,t,"read from private field"),s?s.call(e):t.get(e)),f=(e,t,s)=>t.has(e)?x("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),S=(e,t,s,i)=>(M(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),m=(e,t,s)=>(M(e,t,"access private method"),s);import{S as L,v as P,w as R,x as V,y as U,a as k,r as d}from"./index-B_pBohjf.js";import{n as q,s as N}from"./utils-km2FGkQ4.js";var h,c,o,u,a,y,I,K,Q=(K=class extends L{constructor(t,s){super();f(this,a);f(this,h);f(this,c);f(this,o);f(this,u);S(this,h,t),this.setOptions(s),this.bindMethods(),m(this,a,y).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var i;const s=this.options;this.options=r(this,h).defaultMutationOptions(t),P(this.options,s)||r(this,h).getMutationCache().notify({type:"observerOptionsUpdated",mutation:r(this,o),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&R(s.mutationKey)!==R(this.options.mutationKey)?this.reset():((i=r(this,o))==null?void 0:i.state.status)==="pending"&&r(this,o).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=r(this,o))==null||t.removeObserver(this)}onMutationUpdate(t){m(this,a,y).call(this),m(this,a,I).call(this,t)}getCurrentResult(){return r(this,c)}reset(){var t;(t=r(this,o))==null||t.removeObserver(this),S(this,o,void 0),m(this,a,y).call(this),m(this,a,I).call(this)}mutate(t,s){var i;return S(this,u,s),(i=r(this,o))==null||i.removeObserver(this),S(this,o,r(this,h).getMutationCache().build(r(this,h),this.options)),r(this,o).addObserver(this),r(this,o).execute(t)}},h=new WeakMap,c=new WeakMap,o=new WeakMap,u=new WeakMap,a=new WeakSet,y=function(){var s;const t=((s=r(this,o))==null?void 0:s.state)??V();S(this,c,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},I=function(t){U.batch(()=>{var s,i,n,O,l,b,C,D;if(r(this,u)&&this.hasListeners()){const p=r(this,c).variables,E=r(this,c).context;(t==null?void 0:t.type)==="success"?((i=(s=r(this,u)).onSuccess)==null||i.call(s,t.data,p,E),(O=(n=r(this,u)).onSettled)==null||O.call(n,t.data,null,p,E)):(t==null?void 0:t.type)==="error"&&((b=(l=r(this,u)).onError)==null||b.call(l,t.error,p,E),(D=(C=r(this,u)).onSettled)==null||D.call(C,void 0,t.error,p,E))}this.listeners.forEach(p=>{p(r(this,c))})})},K);function J(e,t){const s=k(),[i]=d.useState(()=>new Q(s,e));d.useEffect(()=>{i.setOptions(e)},[i,e]);const n=d.useSyncExternalStore(d.useCallback(l=>i.subscribe(U.batchCalls(l)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),O=d.useCallback((l,b)=>{i.mutate(l,b).catch(q)},[i]);if(n.error&&N(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:O,mutateAsync:n.mutate}}const j=1,F=1e6;let _=0;function G(){return _=(_+1)%Number.MAX_SAFE_INTEGER,_.toString()}const g=new Map,w=e=>{if(g.has(e))return;const t=setTimeout(()=>{g.delete(e),T({type:"REMOVE_TOAST",toastId:e})},F);g.set(e,t)},X=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,j)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?w(s):e.toasts.forEach(i=>{w(i.id)}),{...e,toasts:e.toasts.map(i=>i.id===s||s===void 0?{...i,open:!1}:i)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==t.toastId)}}},v=[];let A={toasts:[]};function T(e){A=X(A,e),v.forEach(t=>{t(A)})}function Y({...e}){const t=G(),s=n=>T({type:"UPDATE_TOAST",toast:{...n,id:t}}),i=()=>T({type:"DISMISS_TOAST",toastId:t});return T({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:n=>{n||i()}}}),{id:t,dismiss:i,update:s}}function W(){const[e,t]=d.useState(A);return d.useEffect(()=>(v.push(t),()=>{const s=v.indexOf(t);s>-1&&v.splice(s,1)}),[e]),{...e,toast:Y,dismiss:s=>T({type:"DISMISS_TOAST",toastId:s})}}export{J as a,W as u};
