import{c as b,r as q,j as e,d as I,a as $,L as y,q as k,k as T}from"./index-C8fLGFJh.js";import{u}from"./useQuery-DueBIpiR.js";import{u as M}from"./useMutation-DDhg2ePi.js";import{C as d,c as n,a as x,b as o}from"./card-GbOed6mg.js";import{B as j}from"./button-dYtoLpIz.js";import{B as m}from"./badge-CjLB_lGN.js";import{S as E}from"./separator-C2TKvTH6.js";import{A as C}from"./arrow-left-CuUWX7If.js";import{P as R}from"./play-DF7goTtl.js";import{P as L}from"./pause-DrT8PjDK.js";import{U as f}from"./users-BrFF6HMn.js";import{C as Q}from"./clock-DNm2UMQf.js";import{T as S}from"./trophy-3qvjUIUt.js";import{C as D}from"./calendar-nen8wffC.js";import{M as z}from"./map-pin-BHE1fp5t.js";import{B as A}from"./building-C9RokV-y.js";import{M as _}from"./mail-3EVUQ_NN.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],U=b("globe",B);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],H=b("info",F);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],O=b("phone",K);function G({value:v,size:a=200}){const[g,s]=q.useState(!1),[h,c]=q.useState(!0),i=`https://api.qrserver.com/v1/create-qr-code/?size=${a}x${a}&data=${encodeURIComponent(v)}`,l=()=>{c(!1)},p=()=>{s(!0),c(!1)};return g?e.jsx("div",{className:"flex items-center justify-center border border-gray-200 rounded-lg bg-gray-50 w-48 h-48","data-testid":"qr-code-fallback",children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2",children:"QR Code"}),e.jsx("div",{className:"text-xs text-gray-500 break-all",children:v})]})}):e.jsxs("div",{className:"flex items-center justify-center","data-testid":"qr-code-container",children:[h&&e.jsx("div",{className:"flex items-center justify-center border border-gray-200 rounded-lg bg-gray-50 animate-pulse w-48 h-48","data-testid":"qr-code-loading",children:e.jsx("div",{className:"text-sm text-gray-500",children:"Loading QR..."})}),e.jsx("img",{src:i,alt:"QR Code",className:`border border-gray-200 rounded-lg ${h?"hidden":""}`,width:a,height:a,onLoad:l,onError:p,"data-testid":"qr-code-image"})]})}function oe(){const[,v]=I("/event/:id"),a=v?.id,{toast:g}=$();console.log("EventHost: Component mounted with eventId:",a);const{data:s,isLoading:h}=u({queryKey:["/api/events",a],enabled:!!a}),{data:c}=u({queryKey:["/api/events",a,"questions"],enabled:!!a}),{data:i}=u({queryKey:["/api/events",a,"participants"],enabled:!!a}),{data:l}=u({queryKey:["/api/events",a,"teams"],enabled:!!a});console.log("EventHost: Query states:",{eventId:a,isLoading:h,hasEvent:!!s,hasQuestions:!!c,hasParticipants:!!i,hasTeams:!!l});const p=M({mutationFn:async()=>{const t=await fetch(`/api/events/${a}/start`,{method:"POST"});if(!t.ok)throw new Error("Failed to start event");return t.json()},onSuccess:()=>{k.invalidateQueries({queryKey:["/api/events",a]}),g({title:"Event Started",description:"Your trivia event is now live!"})},onError:()=>{g({title:"Error",description:"Failed to start event. Please try again.",variant:"destructive"})}});if(h)return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})});if(!s)return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(d,{className:"text-center p-8","data-testid":"card-event-not-found",children:e.jsxs(n,{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2","data-testid":"text-event-not-found",children:"Event Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4","data-testid":"text-event-not-found-desc",children:"The event you're looking for doesn't exist or has been removed."}),e.jsx(y,{href:"/dashboard",children:e.jsxs(j,{"data-testid":"button-back-to-dashboard",children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})})]})})});const P=(t,r)=>t?T(t):"No date set";return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(y,{href:"/dashboard",children:e.jsxs(j,{variant:"ghost",size:"sm","data-testid":"button-back",children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Back"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900","data-testid":"text-event-title",children:s.title}),e.jsx("p",{className:"text-gray-600","data-testid":"text-event-description",children:s.description})]})]}),e.jsx(m,{variant:s.status==="active"?"default":"secondary","data-testid":"badge-event-status",children:s.status==="active"?"Live":s.status})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(d,{className:"trivia-card","data-testid":"card-control-panel",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-control-panel-title",children:"Event Control Panel"})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[s.status==="draft"?e.jsxs(j,{onClick:()=>p.mutate(),disabled:p.isPending,className:"trivia-button-primary","data-testid":"button-start-event",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),p.isPending?"Starting...":"Start Event"]}):e.jsxs(j,{className:"trivia-button-secondary",disabled:!0,"data-testid":"button-pause-event",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Pause Event"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(f,{className:"mr-1 h-4 w-4"}),e.jsxs("span",{"data-testid":"text-participant-count",children:[i?.length||0," participants"]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Q,{className:"mr-1 h-4 w-4"}),e.jsxs("span",{"data-testid":"text-question-count",children:[c?.length||0," questions"]})]})]}),e.jsx(y,{href:`/presenter/${a}`,children:e.jsxs(j,{variant:"outline",className:"trivia-button-outline","data-testid":"button-presenter-view",children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Presenter View"]})})]})})]}),s.status==="draft"&&e.jsxs(d,{className:"trivia-card","data-testid":"card-teams-participants",children:[e.jsx(x,{children:e.jsxs(o,{className:"flex items-center","data-testid":"text-teams-participants-title",children:[e.jsx(f,{className:"mr-2 h-5 w-5"}),"Teams & Participants"]})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Teams (",l?.length||0,")"]}),l&&l.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(t=>e.jsxs("div",{className:"p-4 bg-champagne-50 rounded-lg border border-champagne-200","data-testid":`team-card-${t.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-champagne-800",children:t.name}),t.tableNumber&&e.jsxs(m,{variant:"outline",className:"text-xs",children:["Table ",t.tableNumber]})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[t.participantCount||0,"/",t.maxMembers||6," members"]}),t.participants&&t.participants.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Members:"}),t.participants.slice(0,3).map((r,N)=>e.jsxs("div",{className:"text-xs text-gray-600",children:["• ",r.name]},r.id)),t.participants.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["... and ",t.participants.length-3," more"]})]})]},t.id))}):e.jsx("div",{className:"text-sm text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"No teams created yet. Participants can create teams when joining."})]}),e.jsx(E,{}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Individual Participants (",i?.filter(t=>!t.teamId).length||0,")"]}),i&&i.filter(t=>!t.teamId).length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:i.filter(t=>!t.teamId).map(t=>e.jsxs("div",{className:"p-3 bg-wine-50 rounded-lg border border-wine-200","data-testid":`participant-card-${t.id}`,children:[e.jsx("div",{className:"text-sm font-medium text-wine-800 truncate",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.joinedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id))}):e.jsx("div",{className:"text-sm text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"No individual participants yet."})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:l?.length||0}),e.jsx("div",{className:"text-sm text-blue-600",children:"Teams"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:i?.length||0}),e.jsx("div",{className:"text-sm text-blue-600",children:"Total Participants"})]})]}),(i?.length||0)>0&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("div",{className:"text-sm text-blue-700",children:["Team Members: ",i?.filter(t=>t.teamId).length||0," • Individual: ",i?.filter(t=>!t.teamId).length||0]})})]})]})})]}),e.jsxs(d,{className:"trivia-card","data-testid":"card-questions-list",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-questions-title",children:"Event Questions"})}),e.jsx(n,{children:c&&c.length>0?e.jsx("div",{className:"space-y-4",children:c.map((t,r)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg","data-testid":`question-${r}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900","data-testid":`text-question-${r}`,children:[r+1,". ",t.question]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{variant:"outline","data-testid":`badge-question-type-${r}`,children:t.type.replace("_"," ")}),e.jsx(m,{variant:"secondary","data-testid":`badge-question-difficulty-${r}`,children:t.difficulty})]})]}),t.options&&t.options.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-3",children:t.options.map((N,w)=>e.jsx("div",{className:`p-2 text-sm rounded border ${N===t.correctAnswer?"border-emerald-300 bg-emerald-50 text-emerald-800":"border-gray-200 bg-gray-50"}`,"data-testid":`option-${r}-${w}`,children:N},w))})]},t.id))}):e.jsx("p",{className:"text-gray-500 text-center py-8","data-testid":"text-no-questions",children:"No questions have been added to this event yet."})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{className:"trivia-card","data-testid":"card-qr-code",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-qr-title",children:"Event QR Code"})}),e.jsx(n,{className:"text-center",children:s.qrCode?e.jsxs(e.Fragment,{children:[e.jsx(G,{value:`${window.location.origin}/join/${s.qrCode}`}),e.jsxs("p",{className:"text-sm text-gray-600 mt-4","data-testid":"text-qr-code",children:["Code: ",e.jsx("span",{className:"font-mono font-bold",children:s.qrCode})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2","data-testid":"text-qr-instruction",children:"Participants can scan this QR code to join your event"})]}):e.jsx("div",{className:"text-gray-500 py-8","data-testid":"text-no-qr-code",children:"No QR code available for this event"})})]}),e.jsxs(d,{className:"trivia-card","data-testid":"card-event-details",children:[e.jsx(x,{children:e.jsxs(o,{className:"flex items-center","data-testid":"text-details-title",children:[e.jsx(H,{className:"mr-2 h-5 w-5"}),"Event Details"]})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-4",children:[s.eventDate&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Date & Time"}),e.jsx("p",{className:"font-medium","data-testid":"text-event-datetime",children:P(s.eventDate,s.eventTime)})]})]}),s.location&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Location"}),e.jsx("p",{className:"font-medium","data-testid":"text-event-location",children:s.location})]})]}),s.sponsoringOrganization&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(A,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Organization"}),e.jsx("p",{className:"font-medium","data-testid":"text-event-organization",children:s.sponsoringOrganization})]})]}),e.jsx(E,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Max Participants"}),e.jsx("p",{className:"font-semibold","data-testid":"text-max-participants",children:s.maxParticipants})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Difficulty"}),e.jsx(m,{variant:"outline","data-testid":"badge-difficulty",children:s.difficulty})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Event Type"}),e.jsx(m,{variant:"secondary","data-testid":"badge-event-type",children:s.eventType.replace("_"," ")})]})]})})]}),(s.contactEmail||s.contactPhone||s.websiteUrl)&&e.jsxs(d,{className:"trivia-card","data-testid":"card-contact-info",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-contact-title",children:"Contact Information"})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-3",children:[s.contactEmail&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(_,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm","data-testid":"text-contact-email",children:s.contactEmail})]}),s.contactPhone&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(O,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm","data-testid":"text-contact-phone",children:s.contactPhone})]}),s.websiteUrl&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(U,{className:"h-4 w-4 text-gray-500"}),e.jsx("a",{href:s.websiteUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline","data-testid":"link-website",children:s.websiteUrl})]})]})})]}),(s.eventRules||s.prizeInformation||s.specialInstructions)&&e.jsxs(d,{className:"trivia-card","data-testid":"card-event-info",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-event-info-title",children:"Event Information"})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-4",children:[s.eventRules&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Rules"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line","data-testid":"text-event-rules",children:s.eventRules})]}),s.prizeInformation&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Prizes"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line","data-testid":"text-prize-info",children:s.prizeInformation})]}),s.specialInstructions&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Special Instructions"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line","data-testid":"text-special-instructions",children:s.specialInstructions})]})]})})]}),e.jsxs(d,{className:"trivia-card","data-testid":"card-participants",children:[e.jsx(x,{children:e.jsxs(o,{className:"flex items-center","data-testid":"text-participants-title",children:[e.jsx(f,{className:"mr-2 h-5 w-5"}),"Participants (",i?.length||0,")"]})}),e.jsx(n,{children:i&&i.length>0?e.jsx("div",{className:"space-y-2",children:i.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded","data-testid":`participant-${r}`,children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium","data-testid":`text-participant-name-${r}`,children:t.name}),t.teamName&&e.jsxs("span",{className:"text-sm text-gray-600 ml-2","data-testid":`text-participant-team-${r}`,children:["(",t.teamName,")"]})]}),e.jsx(m,{variant:t.isActive?"default":"secondary","data-testid":`badge-participant-status-${r}`,children:t.isActive?"Active":"Inactive"})]},t.id))}):e.jsx("p",{className:"text-gray-500 text-center py-4","data-testid":"text-no-participants",children:"No participants yet. Share the QR code to get started!"})})]})]})]})]})}export{oe as default};
