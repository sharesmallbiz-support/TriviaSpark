import{c as b,r as E,j as e,d as I,a as $,L as y,i as k,q as T}from"./index-GJ-gZReu.js";import{u}from"./useQuery-Btm1LuuT.js";import{u as M}from"./useMutation-nthHfX2C.js";import{C as c,c as l,a as x,b as o}from"./card-BEVdS6nE.js";import{B as v}from"./button-DhDJwChb.js";import{B as m}from"./badge-CIPpHvzq.js";import{S as q}from"./separator-C1Wo0Nwk.js";import{A as C}from"./arrow-left-BSt5JxV6.js";import{P as R}from"./play-9RP6q56s.js";import{P as L}from"./pause-D2ecJ-b-.js";import{U as f}from"./users-DBNeF1i8.js";import{C as Q}from"./clock-Cqx_XSHL.js";import{T as S}from"./trophy-B_qnz77k.js";import{C as z}from"./calendar-CFaN37se.js";import{M as D}from"./map-pin-D3P5LjJ-.js";import{B as A}from"./building-TTtqUr2L.js";import{M as B}from"./mail-3zEQS8zT.js";import"./utils-km2FGkQ4.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=b("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=b("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=b("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);function K({value:h,size:i=200}){const[g,s]=E.useState(!1),[j,n]=E.useState(!0),a=`https://api.qrserver.com/v1/create-qr-code/?size=${i}x${i}&data=${encodeURIComponent(h)}`,d=()=>{n(!1)},p=()=>{s(!0),n(!1)};return g?e.jsx("div",{className:"flex items-center justify-center border border-gray-200 rounded-lg bg-gray-50 w-48 h-48","data-testid":"qr-code-fallback",children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2",children:"QR Code"}),e.jsx("div",{className:"text-xs text-gray-500 break-all",children:h})]})}):e.jsxs("div",{className:"flex items-center justify-center","data-testid":"qr-code-container",children:[j&&e.jsx("div",{className:"flex items-center justify-center border border-gray-200 rounded-lg bg-gray-50 animate-pulse w-48 h-48","data-testid":"qr-code-loading",children:e.jsx("div",{className:"text-sm text-gray-500",children:"Loading QR..."})}),e.jsx("img",{src:a,alt:"QR Code",className:`border border-gray-200 rounded-lg ${j?"hidden":""}`,width:i,height:i,onLoad:d,onError:p,"data-testid":"qr-code-image"})]})}function le(){const[,h]=I("/event/:id"),i=h==null?void 0:h.id,{toast:g}=$();console.log("EventHost: Component mounted with eventId:",i);const{data:s,isLoading:j}=u({queryKey:["/api/events",i],enabled:!!i}),{data:n}=u({queryKey:["/api/events",i,"questions"],enabled:!!i}),{data:a}=u({queryKey:["/api/events",i,"participants"],enabled:!!i}),{data:d}=u({queryKey:["/api/events",i,"teams"],enabled:!!i});console.log("EventHost: Query states:",{eventId:i,isLoading:j,hasEvent:!!s,hasQuestions:!!n,hasParticipants:!!a,hasTeams:!!d});const p=M({mutationFn:async()=>{const t=await fetch(`/api/events/${i}/start`,{method:"POST"});if(!t.ok)throw new Error("Failed to start event");return t.json()},onSuccess:()=>{T.invalidateQueries({queryKey:["/api/events",i]}),g({title:"Event Started",description:"Your trivia event is now live!"})},onError:()=>{g({title:"Error",description:"Failed to start event. Please try again.",variant:"destructive"})}});if(j)return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})});if(!s)return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(c,{className:"text-center p-8","data-testid":"card-event-not-found",children:e.jsxs(l,{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2","data-testid":"text-event-not-found",children:"Event Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4","data-testid":"text-event-not-found-desc",children:"The event you're looking for doesn't exist or has been removed."}),e.jsx(y,{href:"/dashboard",children:e.jsxs(v,{"data-testid":"button-back-to-dashboard",children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})})]})})});const P=(t,r)=>t?k(t):"No date set";return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(y,{href:"/dashboard",children:e.jsxs(v,{variant:"ghost",size:"sm","data-testid":"button-back",children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Back"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900","data-testid":"text-event-title",children:s.title}),e.jsx("p",{className:"text-gray-600","data-testid":"text-event-description",children:s.description})]})]}),e.jsx(m,{variant:s.status==="active"?"default":"secondary","data-testid":"badge-event-status",children:s.status==="active"?"Live":s.status})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(c,{className:"trivia-card","data-testid":"card-control-panel",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-control-panel-title",children:"Event Control Panel"})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[s.status==="draft"?e.jsxs(v,{onClick:()=>p.mutate(),disabled:p.isPending,className:"trivia-button-primary","data-testid":"button-start-event",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),p.isPending?"Starting...":"Start Event"]}):e.jsxs(v,{className:"trivia-button-secondary",disabled:!0,"data-testid":"button-pause-event",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Pause Event"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(f,{className:"mr-1 h-4 w-4"}),e.jsxs("span",{"data-testid":"text-participant-count",children:[(a==null?void 0:a.length)||0," participants"]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Q,{className:"mr-1 h-4 w-4"}),e.jsxs("span",{"data-testid":"text-question-count",children:[(n==null?void 0:n.length)||0," questions"]})]})]}),e.jsx(y,{href:`/presenter/${i}`,children:e.jsxs(v,{variant:"outline",className:"trivia-button-outline","data-testid":"button-presenter-view",children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Presenter View"]})})]})})]}),s.status==="draft"&&e.jsxs(c,{className:"trivia-card","data-testid":"card-teams-participants",children:[e.jsx(x,{children:e.jsxs(o,{className:"flex items-center","data-testid":"text-teams-participants-title",children:[e.jsx(f,{className:"mr-2 h-5 w-5"}),"Teams & Participants"]})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Teams (",(d==null?void 0:d.length)||0,")"]}),d&&d.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map(t=>e.jsxs("div",{className:"p-4 bg-champagne-50 rounded-lg border border-champagne-200","data-testid":`team-card-${t.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-champagne-800",children:t.name}),t.tableNumber&&e.jsxs(m,{variant:"outline",className:"text-xs",children:["Table ",t.tableNumber]})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[t.participantCount||0,"/",t.maxMembers||6," members"]}),t.participants&&t.participants.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Members:"}),t.participants.slice(0,3).map((r,N)=>e.jsxs("div",{className:"text-xs text-gray-600",children:["• ",r.name]},r.id)),t.participants.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["... and ",t.participants.length-3," more"]})]})]},t.id))}):e.jsx("div",{className:"text-sm text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"No teams created yet. Participants can create teams when joining."})]}),e.jsx(q,{}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Individual Participants (",(a==null?void 0:a.filter(t=>!t.teamId).length)||0,")"]}),a&&a.filter(t=>!t.teamId).length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:a.filter(t=>!t.teamId).map(t=>e.jsxs("div",{className:"p-3 bg-wine-50 rounded-lg border border-wine-200","data-testid":`participant-card-${t.id}`,children:[e.jsx("div",{className:"text-sm font-medium text-wine-800 truncate",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.joinedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id))}):e.jsx("div",{className:"text-sm text-gray-500 bg-gray-50 p-4 rounded-lg text-center",children:"No individual participants yet."})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:(d==null?void 0:d.length)||0}),e.jsx("div",{className:"text-sm text-blue-600",children:"Teams"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:(a==null?void 0:a.length)||0}),e.jsx("div",{className:"text-sm text-blue-600",children:"Total Participants"})]})]}),((a==null?void 0:a.length)||0)>0&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("div",{className:"text-sm text-blue-700",children:["Team Members: ",(a==null?void 0:a.filter(t=>t.teamId).length)||0," • Individual: ",(a==null?void 0:a.filter(t=>!t.teamId).length)||0]})})]})]})})]}),e.jsxs(c,{className:"trivia-card","data-testid":"card-questions-list",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-questions-title",children:"Event Questions"})}),e.jsx(l,{children:n&&n.length>0?e.jsx("div",{className:"space-y-4",children:n.map((t,r)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg","data-testid":`question-${r}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900","data-testid":`text-question-${r}`,children:[r+1,". ",t.question]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{variant:"outline","data-testid":`badge-question-type-${r}`,children:t.type.replace("_"," ")}),e.jsx(m,{variant:"secondary","data-testid":`badge-question-difficulty-${r}`,children:t.difficulty})]})]}),t.options&&t.options.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-3",children:t.options.map((N,w)=>e.jsx("div",{className:`p-2 text-sm rounded border ${N===t.correctAnswer?"border-emerald-300 bg-emerald-50 text-emerald-800":"border-gray-200 bg-gray-50"}`,"data-testid":`option-${r}-${w}`,children:N},w))})]},t.id))}):e.jsx("p",{className:"text-gray-500 text-center py-8","data-testid":"text-no-questions",children:"No questions have been added to this event yet."})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(c,{className:"trivia-card","data-testid":"card-qr-code",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-qr-title",children:"Event QR Code"})}),e.jsx(l,{className:"text-center",children:s.qrCode?e.jsxs(e.Fragment,{children:[e.jsx(K,{value:`${window.location.origin}/join/${s.qrCode}`}),e.jsxs("p",{className:"text-sm text-gray-600 mt-4","data-testid":"text-qr-code",children:["Code: ",e.jsx("span",{className:"font-mono font-bold",children:s.qrCode})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2","data-testid":"text-qr-instruction",children:"Participants can scan this QR code to join your event"})]}):e.jsx("div",{className:"text-gray-500 py-8","data-testid":"text-no-qr-code",children:"No QR code available for this event"})})]}),e.jsxs(c,{className:"trivia-card","data-testid":"card-event-details",children:[e.jsx(x,{children:e.jsxs(o,{className:"flex items-center","data-testid":"text-details-title",children:[e.jsx(F,{className:"mr-2 h-5 w-5"}),"Event Details"]})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[s.eventDate&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Date & Time"}),e.jsx("p",{className:"font-medium","data-testid":"text-event-datetime",children:P(s.eventDate,s.eventTime)})]})]}),s.location&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Location"}),e.jsx("p",{className:"font-medium","data-testid":"text-event-location",children:s.location})]})]}),s.sponsoringOrganization&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(A,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Organization"}),e.jsx("p",{className:"font-medium","data-testid":"text-event-organization",children:s.sponsoringOrganization})]})]}),e.jsx(q,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Max Participants"}),e.jsx("p",{className:"font-semibold","data-testid":"text-max-participants",children:s.maxParticipants})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Difficulty"}),e.jsx(m,{variant:"outline","data-testid":"badge-difficulty",children:s.difficulty})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Event Type"}),e.jsx(m,{variant:"secondary","data-testid":"badge-event-type",children:s.eventType.replace("_"," ")})]})]})})]}),(s.contactEmail||s.contactPhone||s.websiteUrl)&&e.jsxs(c,{className:"trivia-card","data-testid":"card-contact-info",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-contact-title",children:"Contact Information"})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-3",children:[s.contactEmail&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(B,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm","data-testid":"text-contact-email",children:s.contactEmail})]}),s.contactPhone&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(H,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm","data-testid":"text-contact-phone",children:s.contactPhone})]}),s.websiteUrl&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(U,{className:"h-4 w-4 text-gray-500"}),e.jsx("a",{href:s.websiteUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline","data-testid":"link-website",children:s.websiteUrl})]})]})})]}),(s.eventRules||s.prizeInformation||s.specialInstructions)&&e.jsxs(c,{className:"trivia-card","data-testid":"card-event-info",children:[e.jsx(x,{children:e.jsx(o,{"data-testid":"text-event-info-title",children:"Event Information"})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[s.eventRules&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Rules"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line","data-testid":"text-event-rules",children:s.eventRules})]}),s.prizeInformation&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Prizes"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line","data-testid":"text-prize-info",children:s.prizeInformation})]}),s.specialInstructions&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Special Instructions"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line","data-testid":"text-special-instructions",children:s.specialInstructions})]})]})})]}),e.jsxs(c,{className:"trivia-card","data-testid":"card-participants",children:[e.jsx(x,{children:e.jsxs(o,{className:"flex items-center","data-testid":"text-participants-title",children:[e.jsx(f,{className:"mr-2 h-5 w-5"}),"Participants (",(a==null?void 0:a.length)||0,")"]})}),e.jsx(l,{children:a&&a.length>0?e.jsx("div",{className:"space-y-2",children:a.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded","data-testid":`participant-${r}`,children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium","data-testid":`text-participant-name-${r}`,children:t.name}),t.teamName&&e.jsxs("span",{className:"text-sm text-gray-600 ml-2","data-testid":`text-participant-team-${r}`,children:["(",t.teamName,")"]})]}),e.jsx(m,{variant:t.isActive?"default":"secondary","data-testid":`badge-participant-status-${r}`,children:t.isActive?"Active":"Inactive"})]},t.id))}):e.jsx("p",{className:"text-gray-500 text-center py-4","data-testid":"text-no-participants",children:"No participants yet. Share the QR code to get started!"})})]})]})]})]})}export{le as default};
