import{c as ce,a as ze,r as g,j as e,d as cs,u as ds,b as os,e as ms}from"./index-BXr8izq5.js";import{u as he}from"./useQuery-C7lBgl7G.js";import{u as ee}from"./useMutation-DZTYW-S7.js";import{L as l,I as m,u as xs}from"./label-D8k-tJu8.js";import{B as u}from"./button-Dmd7R46Z.js";import{U as hs,T as A,S as us,P as Te}from"./textarea-DpBZpkee.js";import{C as b,a as N,b as C,c as w}from"./card-CiFSfb_x.js";import{B as D}from"./badge-ymd6zgSY.js";import{S as V}from"./sparkles-Da_quMXf.js";import{M as Oe}from"./mail-1-WLJ8vd.js";import{B as Qe}from"./building-2-2fsmcBrv.js";import{C as ps}from"./circle-alert-BJJkgkih.js";import{T as $e}from"./trophy-BXr0qYlJ.js";import{F as Be,T as js,a as gs,b as z,c as O}from"./tabs-Dwljvrfh.js";import{C as pe}from"./clock-v6UKdQCy.js";import{U as Ge}from"./users-Cr7aCE4T.js";import{S as Pe,a as De,b as Ee,c as Le,d as M}from"./select-Dq9lgRmf.js";import{B as _}from"./brain-Cx9s3D2p.js";import{A as vs}from"./arrow-left-CJCmomi4.js";import{P as Ie}from"./play-DzaC_dPb.js";import{S as ue,a as qe}from"./square-pen-DDnz964-.js";import{C as fs}from"./calendar-TQCZjxsx.js";import{M as ys}from"./map-pin-BO42OxNX.js";import{P as bs}from"./pause-C9f_vT_7.js";import{S as ws}from"./skip-forward-CjrxguqK.js";import"./utils-km2FGkQ4.js";import"./index-DFtfI3ZH.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=ce("Accessibility",[["circle",{cx:"16",cy:"4",r:"1",key:"1grugj"}],["path",{d:"m18 19 1-7-6 1",key:"r0i19z"}],["path",{d:"m5 8 3-3 5.5 3-2.36 3.5",key:"9ptxx2"}],["path",{d:"M4.24 14.5a5 5 0 0 0 6.88 6",key:"10kmtu"}],["path",{d:"M13.76 17.5a5 5 0 0 0-6.88-6",key:"2qq6rc"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=ce("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=ce("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function Ss({event:i,onUpdate:n,isLoading:x}){const{toast:r}=ze(),[d,h]=g.useState(!1),c=async t=>{h(!0);try{const f=await fetch(`/api/events/${i.id}/generate-copy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:t}),credentials:"include"});if(!f.ok)throw new Error("Failed to generate copy");const k=await f.json();n({[t==="promotional"?"eventCopy":t==="welcome"?"welcomeMessage":t==="thankyou"?"thankYouMessage":"eventRules"]:k.copy}),r({title:"AI Copy Generated",description:`Generated ${t} content successfully!`})}catch{r({title:"Generation Failed",description:"Failed to generate AI copy. Please try again.",variant:"destructive"})}finally{h(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"w-5 h-5"}),"Visual Branding"]})}),e.jsx(w,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"logoUrl",children:"Event Logo URL"}),e.jsx(m,{id:"logoUrl",placeholder:"https://example.com/logo.png",value:i.logoUrl||"",onChange:t=>n({logoUrl:t.target.value}),"data-testid":"input-logo-url"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload your event logo for branding"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"backgroundImageUrl",children:"Background Image URL"}),e.jsx(m,{id:"backgroundImageUrl",placeholder:"https://example.com/background.jpg",value:i.backgroundImageUrl||"",onChange:t=>n({backgroundImageUrl:t.target.value}),"data-testid":"input-background-url"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Background image for event screens"})]})]})})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5"}),"Color Theme"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"primaryColor",children:"Primary Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{id:"primaryColor",type:"color",value:i.primaryColor||"#7C2D12",onChange:t=>n({primaryColor:t.target.value}),className:"w-16 h-10 border rounded cursor-pointer","data-testid":"input-primary-color"}),e.jsx(m,{placeholder:"#7C2D12",value:i.primaryColor||"#7C2D12",onChange:t=>n({primaryColor:t.target.value}),className:"flex-1"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"secondaryColor",children:"Secondary Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{id:"secondaryColor",type:"color",value:i.secondaryColor||"#FEF3C7",onChange:t=>n({secondaryColor:t.target.value}),className:"w-16 h-10 border rounded cursor-pointer","data-testid":"input-secondary-color"}),e.jsx(m,{placeholder:"#FEF3C7",value:i.secondaryColor||"#FEF3C7",onChange:t=>n({secondaryColor:t.target.value}),className:"flex-1"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"fontFamily",children:"Font Family"}),e.jsx(m,{id:"fontFamily",placeholder:"Inter",value:i.fontFamily||"Inter",onChange:t=>n({fontFamily:t.target.value}),"data-testid":"input-font-family"})]})]}),e.jsx("div",{className:"p-4 border rounded-lg",style:{backgroundColor:i.secondaryColor||"#FEF3C7",fontFamily:i.fontFamily||"Inter"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:i.primaryColor||"#7C2D12"},children:i.title||"Your Event Title"}),e.jsx(D,{style:{backgroundColor:i.primaryColor||"#7C2D12",color:"white"},children:"Theme Preview"})]})})]})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"AI-Generated Content"]})}),e.jsxs(w,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(l,{htmlFor:"eventCopy",children:"Promotional Event Copy"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>c("promotional"),disabled:d,"data-testid":"button-generate-promotional",children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),d?"Generating...":"Generate"]})]}),e.jsx(A,{id:"eventCopy",placeholder:"AI will generate engaging promotional copy for your event...",value:i.eventCopy||"",onChange:t=>n({eventCopy:t.target.value}),rows:4,"data-testid":"textarea-event-copy"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(l,{htmlFor:"welcomeMessage",children:"Welcome Message"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>c("welcome"),disabled:d,"data-testid":"button-generate-welcome",children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),"Generate"]})]}),e.jsx(A,{id:"welcomeMessage",placeholder:"Welcome message shown to participants when they join...",value:i.welcomeMessage||"",onChange:t=>n({welcomeMessage:t.target.value}),rows:3,"data-testid":"textarea-welcome-message"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(l,{htmlFor:"thankYouMessage",children:"Thank You Message"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>c("thankyou"),disabled:d,"data-testid":"button-generate-thankyou",children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),"Generate"]})]}),e.jsx(A,{id:"thankYouMessage",placeholder:"Thank you message shown after event completion...",value:i.thankYouMessage||"",onChange:t=>n({thankYouMessage:t.target.value}),rows:3,"data-testid":"textarea-thank-you-message"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(l,{htmlFor:"eventRules",children:"Event Rules"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>c("rules"),disabled:d,"data-testid":"button-generate-rules",children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),"Generate"]})]}),e.jsx(A,{id:"eventRules",placeholder:"Clear rules and guidelines for participants...",value:i.eventRules||"",onChange:t=>n({eventRules:t.target.value}),rows:4,"data-testid":"textarea-event-rules"})]})]})]})]})}function Fs({event:i,onUpdate:n,isLoading:x}){const r=(t,f)=>{const T={...i.socialLinks?JSON.parse(i.socialLinks):{},[t]:f};n({socialLinks:JSON.stringify(T)})},d=(t,f)=>{const T={...i.sponsorInformation?JSON.parse(i.sponsorInformation):{},[t]:f};n({sponsorInformation:JSON.stringify(T)})},h=i.socialLinks?JSON.parse(i.socialLinks):{},c=i.sponsorInformation?JSON.parse(i.sponsorInformation):{};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-5 h-5"}),"Contact Information"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"contactEmail",children:"Contact Email"}),e.jsx(m,{id:"contactEmail",type:"email",placeholder:"contact@example.com",value:i.contactEmail||"",onChange:t=>n({contactEmail:t.target.value}),"data-testid":"input-contact-email"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"contactPhone",children:"Contact Phone"}),e.jsx(m,{id:"contactPhone",type:"tel",placeholder:"+1 (555) 123-4567",value:i.contactPhone||"",onChange:t=>n({contactPhone:t.target.value}),"data-testid":"input-contact-phone"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"websiteUrl",children:"Website URL"}),e.jsx(m,{id:"websiteUrl",type:"url",placeholder:"https://yourorganization.com",value:i.websiteUrl||"",onChange:t=>n({websiteUrl:t.target.value}),"data-testid":"input-website-url"})]})]})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"w-5 h-5"}),"Social Media Links"]})}),e.jsx(w,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"facebook",children:"Facebook"}),e.jsx(m,{id:"facebook",placeholder:"https://facebook.com/yourpage",value:h.facebook||"",onChange:t=>r("facebook",t.target.value),"data-testid":"input-facebook"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"twitter",children:"Twitter/X"}),e.jsx(m,{id:"twitter",placeholder:"https://twitter.com/yourhandle",value:h.twitter||"",onChange:t=>r("twitter",t.target.value),"data-testid":"input-twitter"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"instagram",children:"Instagram"}),e.jsx(m,{id:"instagram",placeholder:"https://instagram.com/yourhandle",value:h.instagram||"",onChange:t=>r("instagram",t.target.value),"data-testid":"input-instagram"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"linkedin",children:"LinkedIn"}),e.jsx(m,{id:"linkedin",placeholder:"https://linkedin.com/company/yourorg",value:h.linkedin||"",onChange:t=>r("linkedin",t.target.value),"data-testid":"input-linkedin"})]})]})})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"w-5 h-5"}),"Sponsor Information"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"sponsorName",children:"Main Sponsor Name"}),e.jsx(m,{id:"sponsorName",placeholder:"Sponsor Company Name",value:c.name||"",onChange:t=>d("name",t.target.value),"data-testid":"input-sponsor-name"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"sponsorLogoUrl",children:"Sponsor Logo URL"}),e.jsx(m,{id:"sponsorLogoUrl",placeholder:"https://sponsor.com/logo.png",value:c.logoUrl||"",onChange:t=>d("logoUrl",t.target.value),"data-testid":"input-sponsor-logo"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"sponsorWebsite",children:"Sponsor Website"}),e.jsx(m,{id:"sponsorWebsite",type:"url",placeholder:"https://sponsor.com",value:c.website||"",onChange:t=>d("website",t.target.value),"data-testid":"input-sponsor-website"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"sponsorDescription",children:"Sponsor Description"}),e.jsx(A,{id:"sponsorDescription",placeholder:"Brief description of the sponsor and their involvement...",value:c.description||"",onChange:t=>d("description",t.target.value),rows:3,"data-testid":"textarea-sponsor-description"})]})]})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(ps,{className:"w-5 h-5"}),"Policies & Terms"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"cancellationPolicy",children:"Cancellation Policy"}),e.jsx(A,{id:"cancellationPolicy",placeholder:"Explain your event cancellation policy...",value:i.cancellationPolicy||"",onChange:t=>n({cancellationPolicy:t.target.value}),rows:3,"data-testid":"textarea-cancellation-policy"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"refundPolicy",children:"Refund Policy"}),e.jsx(A,{id:"refundPolicy",placeholder:"Explain your refund policy for participants...",value:i.refundPolicy||"",onChange:t=>n({refundPolicy:t.target.value}),rows:3,"data-testid":"textarea-refund-policy"})]})]})]})]})}function As({event:i,onUpdate:n,isLoading:x}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5"}),"Prize Information"]})}),e.jsx(w,{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(l,{htmlFor:"prizeInformation",children:"Prize Details"}),e.jsx(A,{id:"prizeInformation",placeholder:"Describe the prizes and rewards for participants...",value:i.prizeInformation||"",onChange:r=>n({prizeInformation:r.target.value}),rows:4,"data-testid":"textarea-prize-information"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Detail what winners can expect to receive"})]})})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"w-5 h-5"}),"Event Instructions"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"specialInstructions",children:"Special Instructions"}),e.jsx(A,{id:"specialInstructions",placeholder:"Any special instructions for participants...",value:i.specialInstructions||"",onChange:r=>n({specialInstructions:r.target.value}),rows:3,"data-testid":"textarea-special-instructions"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"technicalRequirements",children:"Technical Requirements"}),e.jsx(A,{id:"technicalRequirements",placeholder:"Device requirements, internet speed, software needed...",value:i.technicalRequirements||"",onChange:r=>n({technicalRequirements:r.target.value}),rows:3,"data-testid":"textarea-technical-requirements"})]})]})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Registration & Timing"]})}),e.jsx(w,{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(l,{htmlFor:"registrationDeadline",children:"Registration Deadline"}),e.jsx(m,{id:"registrationDeadline",type:"datetime-local",value:i.registrationDeadline?new Date(i.registrationDeadline).toISOString().slice(0,16):"",onChange:r=>n({registrationDeadline:r.target.value?new Date(r.target.value).toISOString():null}),"data-testid":"input-registration-deadline"})]})})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5"}),"Participant Requirements"]})}),e.jsx(w,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"ageRestrictions",children:"Age Restrictions"}),e.jsx(m,{id:"ageRestrictions",placeholder:"e.g., 18+ or All ages welcome",value:i.ageRestrictions||"",onChange:r=>n({ageRestrictions:r.target.value}),"data-testid":"input-age-restrictions"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"dressCode",children:"Dress Code"}),e.jsx(m,{id:"dressCode",placeholder:"e.g., Business casual, Themed attire",value:i.dressCode||"",onChange:r=>n({dressCode:r.target.value}),"data-testid":"input-dress-code"})]})]})})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"w-5 h-5"}),"Accessibility & Accommodations"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"accessibilityInfo",children:"Accessibility Information"}),e.jsx(A,{id:"accessibilityInfo",placeholder:"Accessibility features and accommodations available...",value:i.accessibilityInfo||"",onChange:r=>n({accessibilityInfo:r.target.value}),rows:3,"data-testid":"textarea-accessibility-info"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"dietaryAccommodations",children:"Dietary Accommodations"}),e.jsx(A,{id:"dietaryAccommodations",placeholder:"Food allergies, dietary restrictions, special meal options...",value:i.dietaryAccommodations||"",onChange:r=>n({dietaryAccommodations:r.target.value}),rows:3,"data-testid":"textarea-dietary-accommodations"})]})]})]})]})}function lt(){const[,i]=cs("/events/:id/manage"),[,n]=ds(),{toast:x}=ze(),r=os(),[d,h]=g.useState(0),[c,t]=g.useState(!1),[f,k]=g.useState(!1),[T,de]=g.useState(null),[se,je]=g.useState(!1),[J,ge]=g.useState(""),[L,Y]=g.useState(30),[U,I]=g.useState(0),[E,te]=g.useState(!1),[ve,Q]=g.useState(!1),[R,oe]=g.useState("both"),{isConnected:Ds,sendMessage:H,connect:Ue,disconnect:Es,messages:ae}=ms(),[q,W]=g.useState([{id:"team1",name:"Team 1",selectedAnswer:null,answerLocked:!1,score:0},{id:"team2",name:"Team 2",selectedAnswer:null,answerLocked:!1,score:0}]),[We,fe]=g.useState(!1),[Ke,ye]=g.useState(!1);g.useState("");const[be,_e]=g.useState(!1),j=i==null?void 0:i.id,{data:o,isLoading:Je}=he({queryKey:["/api/events",j],enabled:!!j,retry:!1}),{data:v=[],isLoading:Ls}=he({queryKey:["/api/events",j,"questions"],enabled:!!j,retry:!1}),{data:me=[],isLoading:Ye}=he({queryKey:["/api/events",j,"fun-facts"],enabled:!!j,retry:!1}),{register:$,handleSubmit:He,setValue:X,watch:we,reset:Ne,formState:{errors:ie,isDirty:Xe}}=xs({defaultValues:{title:"",description:"",eventType:"",maxParticipants:50,difficulty:"medium",eventDate:"",eventTime:"",location:"",sponsoringOrganization:""}});g.useEffect(()=>{if(o){const s={title:o.title||"",description:o.description||"",eventType:o.eventType||"",maxParticipants:o.maxParticipants||50,difficulty:o.difficulty||"medium",eventDate:o.eventDate?new Date(new Date(o.eventDate).getTime()+new Date(o.eventDate).getTimezoneOffset()*6e4).toISOString().split("T")[0]:"",eventTime:o.eventTime||"",location:o.location||"",sponsoringOrganization:o.sponsoringOrganization||""};Ne(s)}},[o,Ne]);const K=ee({mutationFn:async s=>{const a=await fetch(`/api/events/${j}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"});if(!a.ok){const p=await a.json();throw new Error(p.error||"Failed to update event")}return a.json()},onSuccess:()=>{r.invalidateQueries({queryKey:["/api/events",j]}),r.invalidateQueries({queryKey:["/api/events"]}),x({title:"Event Updated",description:"Event details have been saved successfully."})},onError:s=>{x({title:"Update Failed",description:s.message,variant:"destructive"})}}),Z=ee({mutationFn:async s=>{const a=await fetch(`/api/events/${j}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s}),credentials:"include"});if(!a.ok){const p=await a.json();throw new Error(p.error||"Failed to update status")}return a.json()},onSuccess:s=>{r.invalidateQueries({queryKey:["/api/events",j]}),r.invalidateQueries({queryKey:["/api/events"]}),x({title:"Status Updated",description:`Event status changed to ${s.status}.`})},onError:s=>{x({title:"Status Update Failed",description:s.message,variant:"destructive"})}}),Ze=s=>{K.mutate(s)},ne=s=>{Z.mutate(s)},es=()=>{if(v.length===0){x({title:"No Questions",description:"Add some questions to your event before running a dry run.",variant:"destructive"});return}t(!0),h(0),k(!1),te(!1),Y(30),I(0),Q(!0),j&&(Ue(j,"host","host-user-id","host"),H({type:"event_status_change",eventId:j,data:{status:"dry_run_started",message:"Dry run has started!",question:v[0]}}))},xe=()=>{k(!1),te(!1),Y(30),I(0),fe(!1),ye(!1),W(s=>s.map(a=>({...a,selectedAnswer:null,answerLocked:!1})))},ss=()=>{d<v.length-1?(fe(!0),setTimeout(()=>{h(d+1),xe(),Q(!0)},5e3)):ye(!0)},Ce=(s,a)=>{W(p=>p.map(S=>S.id===s&&!S.answerLocked&&!E?{...S,selectedAnswer:a}:S)),j&&v[d]&&H({type:"participant_answer",eventId:j,data:{participantId:s,questionId:v[d].id,selectedAnswer:a}})},ke=s=>{W(a=>{const p=a.map(y=>{if(y.id===s&&y.selectedAnswer&&!y.answerLocked&&!E){const re=v[d],P=re&&y.selectedAnswer.toLowerCase().trim()===re.correctAnswer.toLowerCase().trim()&&L>0?L:0;return{...y,answerLocked:!0,score:y.score+P}}return y}),S=p.find(y=>y.id===s);return S&&j&&v[d]&&H({type:"lock_answer",eventId:j,data:{participantId:s,questionId:v[d].id,selectedAnswer:S.selectedAnswer,timeRemaining:L}}),p.every(y=>y.answerLocked)&&x({title:"All Teams Answered!",description:"All participants have locked their answers. Revealing results..."}),p})},ts=()=>{E||(k(!f),f||Q(!1))},as=()=>{t(!1),h(0),xe(),Y(30),I(0),Q(!1),W(s=>s.map(a=>({...a,score:0,selectedAnswer:null,answerLocked:!1})))},is=()=>{t(!1),h(0),xe(),Y(30),I(0),Q(!1),W(s=>s.map(a=>({...a,score:0,selectedAnswer:null,answerLocked:!1}))),x({title:"Dry Run Complete",description:"Great job! You've completed the trivia preview."})},ns=ee({mutationFn:async({topic:s,type:a})=>{const p=await fetch("/api/questions/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:j,topic:s,type:a,count:1}),credentials:"include"});if(!p.ok){const S=await p.json();throw new Error(S.error||"Failed to generate question")}return p.json()},onSuccess:()=>{r.invalidateQueries({queryKey:["/api/events",j,"questions"]}),ge(""),x({title:"Question Generated",description:"AI question has been added to your event."})},onError:s=>{x({title:"Generation Failed",description:s.message,variant:"destructive"})}}),Se=ee({mutationFn:async s=>{const a=await fetch(`/api/questions/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"});if(!a.ok){const p=await a.json();throw new Error(p.error||"Failed to update question")}return a.json()},onSuccess:()=>{r.invalidateQueries({queryKey:["/api/events",j,"questions"]}),de(null),x({title:"Question Updated",description:"Question has been saved successfully."})},onError:s=>{x({title:"Update Failed",description:s.message,variant:"destructive"})}}),rs=ee({mutationFn:async s=>{const a=await fetch(`/api/questions/${s}`,{method:"DELETE",credentials:"include"});if(!a.ok){const p=await a.json();throw new Error(p.error||"Failed to delete question")}},onSuccess:()=>{r.invalidateQueries({queryKey:["/api/events",j,"questions"]}),x({title:"Question Deleted",description:"Question has been removed from your event."})},onError:s=>{x({title:"Delete Failed",description:s.message,variant:"destructive"})}}),Fe=s=>{if(!J.trim()){x({title:"Topic Required",description:"Please enter a topic for the AI question.",variant:"destructive"});return}je(!0),ns.mutate({topic:J,type:s},{onSettled:()=>je(!1)})};g.useEffect(()=>{let s;return ve&&L>0&&!f&&(s=setInterval(()=>{Y(a=>a===4?(I(3),a-1):a===3?(I(2),a-1):a===2?(I(1),a-1):a===1?(Q(!1),te(!0),k(!0),I(0),0):a-1)},1e3)),()=>{s&&clearInterval(s)}},[ve,L,f]),g.useEffect(()=>{c&&!f&&!E&&q.length>0&&q.every(a=>a.answerLocked)&&(Q(!1),te(!0),j&&v[d]&&H({type:"answer_revealed",eventId:j,data:{question:v[d],leaderboard:q.map(a=>({name:a.name,score:a.score}))}}),setTimeout(()=>{k(!0)},1e3))},[q,c,f,E,j,v,d,H]),g.useEffect(()=>{if(ae.length>0){const s=ae[ae.length-1];if(s.type==="answer_locked"&&s.data&&!c){const{participantId:a,score:p,isCorrect:S}=s.data;W(F=>F.map(y=>y.id===a?{...y,score:y.score+(p||0)}:y))}}},[ae,c]),g.useEffect(()=>{if(U===1){const s=setTimeout(()=>{I(0)},1e3);return()=>clearTimeout(s)}},[U]);function ls({question:s,onSave:a,onCancel:p,isLoading:S}){const[F,y]=g.useState({question:s.question,correctAnswer:s.correctAnswer,options:Array.isArray(s.options)?[...s.options]:[],points:s.points||100,timeLimit:s.timeLimit||30}),re=(P,G)=>{const le=[...F.options];le[P]=G,y({...F,options:le})},Ae=()=>{const P={...s,question:F.question,correctAnswer:F.correctAnswer,options:F.options,points:F.points,timeLimit:F.timeLimit};a(P)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Question"}),e.jsx(A,{value:F.question,onChange:P=>y({...F,question:P.target.value}),className:"mt-1",rows:2,"data-testid":"textarea-edit-question"})]}),s.type==="multiple_choice"&&e.jsxs("div",{children:[e.jsx(l,{children:"Options"}),e.jsx("div",{className:"space-y-2 mt-1",children:F.options.map((P,G)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"w-8 h-10 bg-gray-100 rounded flex items-center justify-center text-sm font-medium",children:String.fromCharCode(65+G)}),e.jsx(m,{value:P,onChange:le=>re(G,le.target.value),placeholder:`Option ${String.fromCharCode(65+G)}`,"data-testid":`input-edit-option-${G}`})]},G))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Correct Answer"}),e.jsx(m,{value:F.correctAnswer,onChange:P=>y({...F,correctAnswer:P.target.value}),className:"mt-1","data-testid":"input-edit-correct-answer"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Points"}),e.jsx(m,{type:"number",value:F.points,onChange:P=>y({...F,points:parseInt(P.target.value)||100}),className:"mt-1",min:"10",max:"500","data-testid":"input-edit-points"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(u,{onClick:Ae,disabled:S,className:"flex-1","data-testid":"button-save-question",children:S?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"mr-2 h-4 w-4 animate-pulse"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Save Changes"]})}),e.jsx(u,{onClick:p,variant:"outline",disabled:S,"data-testid":"button-cancel-edit",children:"Cancel"})]})]})}if(Je)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-wine-50 to-champagne-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 wine-gradient rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(_,{className:"text-champagne-400 h-8 w-8 animate-pulse"})}),e.jsx("p",{className:"text-wine-700",children:"Loading event..."})]})});if(!o)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-wine-50 to-champagne-50 flex items-center justify-center",children:e.jsx(b,{className:"max-w-md w-full",children:e.jsxs(w,{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Event not found"}),e.jsx(u,{onClick:()=>n("/dashboard"),"data-testid":"button-back-events",children:"Back to Dashboard"})]})})});const B=v[d];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-wine-50 to-champagne-50",children:[e.jsx("div",{className:"wine-gradient shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(u,{variant:"ghost",onClick:()=>n("/dashboard"),className:"text-white hover:bg-white/10 mr-4","data-testid":"button-back",children:[e.jsx(vs,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white","data-testid":"text-page-title",children:"Manage Event"}),e.jsx("p",{className:"text-champagne-200","data-testid":"text-event-title",children:o.title})]})]}),e.jsx(D,{variant:o.status==="active"?"default":"secondary",className:`text-sm ${o.status==="active"?"bg-emerald-100 text-emerald-800":""}`,"data-testid":"badge-event-status",children:o.status})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs(js,{defaultValue:"details",className:"space-y-6",children:[e.jsxs(gs,{className:"grid w-full grid-cols-8","data-testid":"tabs-event-management",children:[e.jsxs(z,{value:"details","data-testid":"tab-details",children:[e.jsx(us,{className:"mr-2 h-4 w-4"}),"Details"]}),e.jsxs(z,{value:"branding","data-testid":"tab-branding",children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Branding"]}),e.jsxs(z,{value:"event-info","data-testid":"tab-event-info",children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),"Event Info"]}),e.jsxs(z,{value:"contact","data-testid":"tab-contact",children:[e.jsx(Oe,{className:"mr-2 h-4 w-4"}),"Contact"]}),e.jsxs(z,{value:"trivia","data-testid":"tab-trivia",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Trivia"]}),e.jsxs(z,{value:"funfacts","data-testid":"tab-funfacts",children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"Fun Facts"]}),e.jsxs(z,{value:"status","data-testid":"tab-status",children:[e.jsx($e,{className:"mr-2 h-4 w-4"}),"Status"]}),e.jsxs(z,{value:"dryrun","data-testid":"tab-dryrun",children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Dry Run"]})]}),e.jsx(O,{value:"branding",children:e.jsx(Ss,{event:o,onUpdate:s=>{Object.keys(s).forEach(a=>{X(a,s[a])})},isLoading:K.isPending})}),e.jsx(O,{value:"event-info",children:e.jsx(As,{event:o,onUpdate:s=>{Object.keys(s).forEach(a=>{X(a,s[a])})},isLoading:K.isPending})}),e.jsx(O,{value:"contact",children:e.jsx(Fs,{event:o,onUpdate:s=>{Object.keys(s).forEach(a=>{X(a,s[a])})},isLoading:K.isPending})}),e.jsx(O,{value:"details",children:e.jsxs(b,{className:"trivia-card","data-testid":"card-event-details",children:[e.jsx(N,{children:e.jsx(C,{className:"wine-text",children:"Edit Event Details"})}),e.jsx(w,{children:e.jsxs("form",{onSubmit:He(Ze),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"title",children:"Event Title *"}),e.jsx(m,{id:"title",...$("title",{required:"Title is required"}),className:"mt-1","data-testid":"input-title"}),ie.title&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:ie.title.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(A,{id:"description",...$("description"),rows:3,className:"mt-1","data-testid":"input-description"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"eventType",children:"Event Type *"}),e.jsxs(Pe,{value:we("eventType")||"",onValueChange:s=>X("eventType",s,{shouldDirty:!0}),children:[e.jsx(De,{className:"mt-1","data-testid":"select-event-type",children:e.jsx(Ee,{placeholder:"Select event type"})}),e.jsxs(Le,{children:[e.jsx(M,{value:"wine-dinner",children:"Wine Dinner"}),e.jsx(M,{value:"corporate",children:"Corporate Event"}),e.jsx(M,{value:"party",children:"Party"}),e.jsx(M,{value:"educational",children:"Educational"}),e.jsx(M,{value:"fundraiser",children:"Fundraiser"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"difficulty",children:"Difficulty"}),e.jsxs(Pe,{value:we("difficulty")||"",onValueChange:s=>X("difficulty",s,{shouldDirty:!0}),children:[e.jsx(De,{className:"mt-1","data-testid":"select-difficulty",children:e.jsx(Ee,{placeholder:"Select difficulty"})}),e.jsxs(Le,{children:[e.jsx(M,{value:"easy",children:"Easy"}),e.jsx(M,{value:"medium",children:"Medium"}),e.jsx(M,{value:"hard",children:"Hard"}),e.jsx(M,{value:"mixed",children:"Mixed"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"maxParticipants",children:"Max Participants"}),e.jsx(m,{id:"maxParticipants",type:"number",...$("maxParticipants",{required:"Max participants is required",min:{value:1,message:"Must be at least 1"},max:{value:500,message:"Maximum 500 participants"},valueAsNumber:!0}),className:"mt-1","data-testid":"input-max-participants"}),ie.maxParticipants&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:ie.maxParticipants.message})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"eventDate",children:"Event Date"}),e.jsx(m,{id:"eventDate",type:"date",...$("eventDate"),className:"mt-1","data-testid":"input-event-date"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"eventTime",children:"Event Time"}),e.jsx(m,{id:"eventTime",...$("eventTime"),placeholder:"e.g., 7:00 PM",className:"mt-1","data-testid":"input-event-time"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"location",children:"Location"}),e.jsx(m,{id:"location",...$("location"),placeholder:"Event venue",className:"mt-1","data-testid":"input-location"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"sponsoringOrganization",children:"Sponsoring Organization"}),e.jsx(m,{id:"sponsoringOrganization",...$("sponsoringOrganization"),placeholder:"Organization name",className:"mt-1","data-testid":"input-sponsoring-org"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{type:"submit",disabled:K.isPending||!Xe,className:"trivia-button-primary","data-testid":"button-save-event",children:K.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})})]})})]})}),e.jsx(O,{value:"trivia",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{className:"trivia-card","data-testid":"card-ai-generation",children:[e.jsx(N,{children:e.jsxs(C,{className:"wine-text flex items-center",children:[e.jsx(V,{className:"mr-2 h-5 w-5"}),"AI Question Generator"]})}),e.jsx(w,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"aiTopic",children:"Topic"}),e.jsx(m,{id:"aiTopic",value:J,onChange:s=>ge(s.target.value),placeholder:"e.g., Pacific Northwest wines, Local history, Sports trivia",className:"mt-1","data-testid":"input-ai-topic"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{onClick:()=>Fe("multiple_choice"),disabled:se||!J.trim(),variant:"outline",className:"flex-1","data-testid":"button-generate-multiple-choice",children:[se?e.jsx(_,{className:"mr-2 h-4 w-4 animate-pulse"}):e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Multiple Choice"]}),e.jsxs(u,{onClick:()=>Fe("true_false"),disabled:se||!J.trim(),variant:"outline",className:"flex-1","data-testid":"button-generate-true-false",children:[se?e.jsx(_,{className:"mr-2 h-4 w-4 animate-pulse"}):e.jsx(Te,{className:"mr-2 h-4 w-4"}),"True/False"]})]})]})})]}),e.jsxs(b,{className:"trivia-card","data-testid":"card-questions-list",children:[e.jsx(N,{children:e.jsx(C,{className:"wine-text flex items-center justify-between",children:e.jsxs("span",{children:["Event Questions (",v.length,")"]})})}),e.jsx(w,{children:v.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(_,{className:"mx-auto h-12 w-12 mb-4 text-gray-400"}),e.jsx("p",{className:"mb-2",children:"No questions yet"}),e.jsx("p",{className:"text-sm",children:"Generate AI questions or add your own to get started"})]}):e.jsx("div",{className:"space-y-4",children:v.map((s,a)=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors","data-testid":`question-${a}`,children:(T==null?void 0:T.id)===s.id?e.jsx(ls,{question:T,onSave:p=>Se.mutate(p),onCancel:()=>de(null),isLoading:Se.isPending}):e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(D,{variant:"secondary",className:"text-xs",children:["#",a+1]}),e.jsx(D,{variant:"outline",className:"text-xs",children:s.type.replace("_"," ")}),s.aiGenerated&&e.jsxs(D,{variant:"outline",className:"text-xs bg-blue-50 text-blue-600",children:[e.jsx(_,{className:"mr-1 h-3 w-3"}),"AI"]}),e.jsxs(D,{variant:"outline",className:"text-xs",children:[s.points||100," pts"]})]}),e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:s.question}),Array.isArray(s.options)&&s.options.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-2",children:s.options.map((p,S)=>e.jsxs("div",{className:`text-sm p-2 rounded ${p===s.correctAnswer?"bg-green-100 text-green-800 font-medium":"bg-gray-100 text-gray-700"}`,children:[String.fromCharCode(65+S),". ",p]},S))}),e.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Correct Answer: ",s.correctAnswer]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx(u,{onClick:()=>de(s),variant:"ghost",size:"sm","data-testid":`button-edit-${a}`,children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsx(u,{onClick:()=>{confirm("Are you sure you want to delete this question?")&&rs.mutate(s.id)},variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50","data-testid":`button-delete-${a}`,children:e.jsx(ks,{className:"h-4 w-4"})})]})]})})},s.id))})})]})]})}),e.jsx(O,{value:"status",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(b,{className:"trivia-card","data-testid":"card-status-control",children:[e.jsx(N,{children:e.jsx(C,{className:"wine-text",children:"Event Status"})}),e.jsxs(w,{className:"space-y-4",children:[e.jsx("div",{className:"text-center",children:e.jsx(D,{variant:o.status==="active"?"default":"secondary",className:`text-lg px-4 py-2 ${o.status==="active"?"bg-emerald-100 text-emerald-800":""}`,"data-testid":"badge-current-status",children:(o.status||"draft").toUpperCase()})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(u,{onClick:()=>ne("draft"),disabled:o.status==="draft"||Z.isPending,variant:o.status==="draft"?"default":"outline","data-testid":"button-set-draft",children:"Draft"}),e.jsx(u,{onClick:()=>ne("active"),disabled:o.status==="active"||Z.isPending,variant:o.status==="active"?"default":"outline","data-testid":"button-set-active",children:"Active"}),e.jsx(u,{onClick:()=>ne("completed"),disabled:o.status==="completed"||Z.isPending,variant:o.status==="completed"?"default":"outline","data-testid":"button-set-completed",children:"Completed"}),e.jsx(u,{onClick:()=>ne("cancelled"),disabled:o.status==="cancelled"||Z.isPending,variant:o.status==="cancelled"?"destructive":"outline","data-testid":"button-set-cancelled",children:"Cancelled"})]})]})]}),e.jsxs(b,{className:"trivia-card","data-testid":"card-event-info",children:[e.jsx(N,{children:e.jsx(C,{className:"wine-text",children:"Event Information"})}),e.jsx(w,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(fs,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Date:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-date",children:o.eventDate?new Date(new Date(o.eventDate).getTime()+new Date(o.eventDate).getTimezoneOffset()*6e4).toLocaleDateString():"Not set"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(pe,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Time:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-time",children:o.eventTime||"Not set"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ys,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Location:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-location",children:o.location||"Not set"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(Qe,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Organization:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-organization",children:o.sponsoringOrganization||"Not set"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(Ge,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Max Participants:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-max-participants",children:o.maxParticipants})]})]})})]})]})}),e.jsx(O,{value:"funfacts",children:e.jsxs(b,{className:"trivia-card","data-testid":"card-fun-facts",children:[e.jsx(N,{children:e.jsxs(C,{className:"wine-text flex items-center justify-between",children:[e.jsx("span",{children:"Fun Facts Management"}),e.jsxs(u,{onClick:()=>_e(!be),variant:"outline","data-testid":"button-edit-fun-facts",children:[e.jsx(qe,{className:"mr-2 h-4 w-4"}),be?"Cancel":"Edit"]})]})}),e.jsx(w,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"Add fun facts about your organization that will be shown between questions during the trivia event."}),Ye?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-wine-600"})}):e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h4",{className:"font-medium mb-2",children:["Current Fun Facts (",me.length,"):"]}),me.length>0?e.jsx("div",{className:"space-y-3",children:me.map((s,a)=>e.jsxs("div",{className:"border-l-4 border-wine-600 pl-3",children:[e.jsxs("h5",{className:"font-medium text-wine-700",children:[a+1,". ",s.title]}),e.jsx("p",{className:"text-gray-700 mt-1",children:s.content})]},s.id))}):e.jsx("p",{className:"text-gray-500",children:"No fun facts available for this event yet."})]})]})})]})}),e.jsx(O,{value:"dryrun",children:e.jsx("div",{className:"space-y-4",children:e.jsxs(b,{className:"trivia-card",children:[e.jsx(N,{children:e.jsxs(C,{className:"wine-text flex items-center justify-between",children:[e.jsx("span",{children:"Dry Run - Test Your Trivia"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:R==="both"?"default":"outline",size:"sm",onClick:()=>oe("both"),"data-testid":"button-view-both",children:"Split View"}),e.jsx(u,{variant:R==="presenter"?"default":"outline",size:"sm",onClick:()=>oe("presenter"),"data-testid":"button-view-presenter",children:"Presenter"}),e.jsx(u,{variant:R==="participant"?"default":"outline",size:"sm",onClick:()=>oe("participant"),"data-testid":"button-view-participant",children:"Participant"})]})]})}),e.jsx(w,{children:c?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(D,{variant:"default",className:"bg-blue-100 text-blue-800","data-testid":"badge-dry-run",children:["Dry Run Active - ",R==="both"?"Split View":R==="presenter"?"Presenter View":"Participant View"]}),e.jsxs("div",{className:"text-sm text-gray-600","data-testid":"text-question-progress",children:["Question ",d+1," of ",v.length]})]}),R==="both"&&B&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-wine-700",children:"üë®‚Äçüè´ Presenter View"}),e.jsx(Me,{question:B,timeLeft:L,finalCountdown:U,showAnswer:f,answersLocked:E})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-wine-700",children:"üë• Participants View"}),e.jsx("div",{className:"space-y-6",children:q.map(s=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h5",{className:"text-md font-semibold text-wine-700",children:[s.name," (Score: ",s.score,")"]}),e.jsx(Re,{question:B,timeLeft:L,finalCountdown:U,showAnswer:f,answersLocked:E,selectedAnswer:s.selectedAnswer,answerLocked:s.answerLocked,onAnswerSelect:a=>Ce(s.id,a),onLockAnswer:()=>ke(s.id)})]},s.id))})]})]}),R!=="both"&&B&&(R==="presenter"?e.jsx(Me,{question:B,timeLeft:L,finalCountdown:U,showAnswer:f,answersLocked:E}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"space-y-2",children:q.map(s=>e.jsxs(D,{variant:"outline",className:"text-lg px-4 py-2 mr-2",children:[s.name,": ",s.score," points"]},s.id))})}),e.jsx("div",{className:"space-y-6",children:q.map(s=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h5",{className:"text-md font-semibold text-wine-700",children:s.name}),e.jsx(Re,{question:B,timeLeft:L,finalCountdown:U,showAnswer:f,answersLocked:E,selectedAnswer:s.selectedAnswer,answerLocked:s.answerLocked,onAnswerSelect:a=>Ce(s.id,a),onLockAnswer:()=>ke(s.id)})]},s.id))})]})),We&&e.jsx(Ps,{participants:q,currentQuestionIndex:d,totalQuestions:v.length,funFacts:["West Wichita Rotary Club has been serving the community since 1985 and has raised over $2 million for local charities! üéâ","Did you know? The Pacific Northwest produces over 99% of American wine grapes, with Washington state being the second-largest wine producer in the US! üç∑","Our trivia nights have helped fund 15 local scholarships, 3 community gardens, and countless meals for families in need. Every question answered makes a difference! üíù","This is our 12th annual Coast to Cascades event! Together, we've welcomed over 600 guests and created lasting memories while supporting worthy causes. üåü"]}),Ke&&e.jsx(Ts,{participants:q,totalQuestions:v.length,onFinish:is}),B&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(u,{onClick:ts,variant:"outline",disabled:E,"data-testid":"button-show-answer",children:f?"Hide Answer":"Show Answer"}),E&&e.jsx("div",{className:"text-sm text-gray-600",children:"Time's up! Answer revealed automatically."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(u,{onClick:as,variant:"outline","data-testid":"button-stop-dry-run",children:[e.jsx(bs,{className:"mr-2 h-4 w-4"}),"Stop"]}),e.jsx(u,{onClick:ss,className:"trivia-button-primary","data-testid":"button-next-question",children:d<v.length-1?e.jsxs(e.Fragment,{children:[e.jsx(ws,{className:"mr-2 h-4 w-4"}),"Next Question"]}):"Finish Dry Run"})]})]})]}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("p",{className:"text-gray-600",children:["Preview your trivia questions as participants would see them.",v.length===0&&" Add some questions first!"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Questions in this event:"}),e.jsx("p",{className:"text-2xl font-bold text-wine-700","data-testid":"text-question-count",children:v.length})]}),e.jsxs(u,{onClick:es,disabled:v.length===0,className:"trivia-button-primary","data-testid":"button-start-dry-run",children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Start Dry Run"]})]})})]})})})]})})]})}function Me({question:i,timeLeft:n,finalCountdown:x,showAnswer:r,answersLocked:d}){return e.jsxs("div",{className:"relative bg-white p-6 rounded-lg border-2 border-wine-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(D,{variant:"secondary","data-testid":"badge-presenter-category",children:i.category}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`flex items-center text-sm ${n<=10?"text-red-600 font-bold":"text-gray-600"}`,children:[e.jsx(pe,{className:"mr-1 h-3 w-3"}),n,"s"]}),d&&e.jsx(D,{variant:"destructive",className:"bg-red-100 text-red-800",children:"üîí Locked"})]})]}),x>0&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10 rounded-lg",children:e.jsx("div",{className:"text-6xl font-bold text-white animate-pulse","data-testid":`presenter-countdown-${x}`,children:x})}),e.jsx("h3",{className:"text-lg font-semibold text-wine-800 mb-4","data-testid":"presenter-question",children:i.question}),e.jsx("div",{className:"space-y-2",children:i.options.map((h,c)=>e.jsxs("div",{className:`p-3 rounded-lg border text-sm transition-colors ${r&&h===i.correctAnswer?"bg-green-100 border-green-300 font-medium":"bg-gray-50 border-gray-200"}`,"data-testid":`presenter-option-${c}`,children:[e.jsxs("span",{className:"font-medium mr-2",children:[String.fromCharCode(65+c),"."]}),h,r&&h===i.correctAnswer&&e.jsx("span",{className:"ml-2 text-green-600 font-semibold",children:"‚úì Correct Answer"})]},c))}),r&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("div",{className:"text-sm font-medium text-green-800",children:"üì± Answer is now visible to participants"})})]})}function Re({question:i,timeLeft:n,finalCountdown:x,showAnswer:r,answersLocked:d,selectedAnswer:h,answerLocked:c,onAnswerSelect:t,onLockAnswer:f}){return e.jsxs("div",{className:"relative bg-gradient-to-br from-wine-50 to-champagne-50 p-6 rounded-lg border-2 border-wine-200 shadow-sm",children:[e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-2",children:[e.jsx(D,{variant:"outline",className:"border-wine-300 text-wine-700",children:i.category}),e.jsxs("div",{className:`text-lg font-bold ${n<=10?"text-red-600":"text-wine-600"}`,children:["‚è∞ ",n,"s"]})]})}),x>0&&e.jsx("div",{className:"absolute top-4 right-4 bg-black bg-opacity-75 rounded-full w-16 h-16 flex items-center justify-center z-10",children:e.jsx("div",{className:"text-2xl font-bold text-white animate-pulse","data-testid":`participant-countdown-${x}`,children:x})}),e.jsx("div",{className:"text-center mb-6",children:e.jsx("h3",{className:"text-lg font-semibold text-wine-800","data-testid":"participant-question",children:i.question})}),e.jsx("div",{className:"space-y-3",children:i.options.map((k,T)=>e.jsxs("button",{disabled:c||d,onClick:()=>t(k),className:`w-full p-4 rounded-lg border-2 text-left transition-all duration-200 ${h===k&&!c&&!d?"bg-wine-100 border-wine-400 ring-2 ring-wine-300":d||c?r&&k===i.correctAnswer?"bg-green-100 border-green-400 text-green-800 font-medium":h===k?"bg-wine-50 border-wine-300 text-wine-800":"bg-gray-100 border-gray-300 text-gray-600":"bg-white border-wine-200 hover:border-wine-300 hover:bg-wine-50 cursor-pointer"}`,"data-testid":`participant-option-${T}`,children:[e.jsx("span",{className:`inline-block w-8 h-8 rounded-full font-bold text-center leading-8 mr-3 ${h===k&&!c&&!d?"bg-wine-300 text-wine-800":"bg-wine-200 text-wine-800"}`,children:String.fromCharCode(65+T)}),k,r&&k===i.correctAnswer&&e.jsx("span",{className:"float-right text-green-600 font-bold text-xl",children:"‚úì"}),h===k&&c&&e.jsx("span",{className:"float-right text-wine-600 font-bold text-xl",children:"üîí"})]},T))}),h&&!c&&!d&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(u,{onClick:f,className:"bg-wine-600 hover:bg-wine-700 text-white px-8 py-3 text-lg font-semibold","data-testid":"button-lock-answer",children:["üîí Lock Answer (Score: ",n," pts)"]})}),c&&!d&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-wine-100 border border-wine-200 rounded-full text-wine-800 font-medium",children:"‚úÖ Answer Locked! Waiting for time to end..."})}),d&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-red-100 border border-red-200 rounded-full text-red-800 font-medium",children:"üîí Time's Up! Answers Revealed"})})]})}function Ts({participants:i,totalQuestions:n,onFinish:x}){const r=[...i].sort((c,t)=>t.score-c.score),d=r[0],h=n*30;return e.jsxs("div",{className:"space-y-8 text-center",children:[e.jsxs("div",{className:"bg-gradient-to-r from-yellow-100 to-yellow-200 p-8 rounded-lg border-2 border-yellow-300",children:[e.jsx("h2",{className:"text-4xl font-bold text-yellow-800 mb-2",children:"üéâ Trivia Complete! üéâ"}),e.jsxs("p",{className:"text-yellow-700 text-lg",children:["All ",n," questions have been answered"]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-champagne-100 to-wine-100 p-8 rounded-lg border-2 border-wine-200",children:[e.jsxs("h3",{className:"text-3xl font-bold text-wine-800 mb-4",children:["üëë Winner: ",d.name,"! üëë"]}),e.jsxs("div",{className:"text-5xl font-bold text-wine-800 mb-2",children:[d.score," points"]}),e.jsxs("p",{className:"text-wine-600 text-lg",children:["Out of ",h," possible points (",Math.round(d.score/h*100),"% accuracy)"]})]}),e.jsxs("div",{className:"bg-white p-8 rounded-lg border-2 border-gray-200 shadow-lg",children:[e.jsx("h4",{className:"text-2xl font-bold text-gray-800 mb-6",children:"üìä Final Leaderboard"}),e.jsx("div",{className:"space-y-4",children:r.map((c,t)=>e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg ${t===0?"bg-yellow-50 border-2 border-yellow-300":t===1?"bg-gray-50 border-2 border-gray-300":"bg-amber-50 border-2 border-amber-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center font-bold text-white text-xl ${t===0?"bg-yellow-500":t===1?"bg-gray-400":"bg-amber-600"}`,children:t===0?"ü•á":t===1?"ü•à":"ü•â"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xl font-bold text-gray-800",children:c.name}),e.jsxs("div",{className:"text-gray-600",children:[Math.round(c.score/h*100),"% accuracy"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:c.score}),e.jsx("div",{className:"text-gray-600",children:"points"})]})]},c.id))})]}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg border-2 border-blue-200",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-700 mb-3",children:"üìà Event Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-blue-800",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:n}),e.jsx("div",{className:"text-sm",children:"Questions Asked"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:Math.round(i.reduce((c,t)=>c+t.score,0)/i.length)}),e.jsx("div",{className:"text-sm",children:"Average Score"})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(u,{onClick:x,className:"bg-wine-600 hover:bg-wine-700 text-white px-8 py-3 text-lg font-semibold","data-testid":"button-finish-dry-run",children:"üèÅ Finish Dry Run"})})]})}function Ps({participants:i,currentQuestionIndex:n,totalQuestions:x,funFacts:r}){const d=[...i].sort((c,t)=>t.score-c.score),h=r[Math.floor(Math.random()*r.length)];return e.jsxs("div",{className:"space-y-6 text-center",children:[e.jsxs("div",{className:"bg-wine-50 p-6 rounded-lg border-2 border-wine-200",children:[e.jsxs("h3",{className:"text-2xl font-bold text-wine-800 mb-2",children:["Question ",n+1," Complete!"]}),e.jsxs("p",{className:"text-wine-600",children:[x-n-1," questions remaining"]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-champagne-100 to-wine-100 p-8 rounded-lg border-2 border-wine-200",children:[e.jsx("h4",{className:"text-lg font-semibold text-wine-700 mb-4",children:"üèÜ Leaderboard"}),e.jsx("div",{className:"space-y-3",children:d.map((c,t)=>e.jsxs("div",{className:"flex items-center justify-between bg-white/50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ${t===0?"bg-yellow-500":t===1?"bg-gray-400":"bg-amber-600"}`,children:t+1}),e.jsx("span",{className:"font-semibold text-wine-800",children:c.name})]}),e.jsxs("div",{className:"text-xl font-bold text-wine-800",children:[c.score," pts"]})]},c.id))}),e.jsx("p",{className:"text-wine-600 text-center mt-4",children:"Keep it up! More points for faster answers!"})]}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg border-2 border-blue-200",children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-700 mb-3",children:"üéâ Did You Know?"}),e.jsx("p",{className:"text-blue-800 text-lg leading-relaxed",children:h})]}),e.jsxs("div",{className:"text-wine-600",children:[e.jsx("p",{children:"Next question starting soon..."}),e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-wine-600"})})]})]})}export{lt as default};
